# 4일차 - 마리아 DB / 리눅스로 WAR 배포 / CRON / 서버간 통신

p.229 까지 마무리

p.617 오라클 설치.

오늘은 마리아 DB

p.580

# 마리아 DB

SQL문은 ANSI표준. SQLD 시험...

VARCHAR(n)

CHAR(n)

INT

FLOAT

DATE

TIME

마리아 DB는 중소 및 공공기관.

오라클은 대기업 및 금융

### 마리아 db 설치

- 다운로드 및 설치

    다음 페이지에 가서 세가지를 다운로드 한다.

    [https://downloads.mariadb.com/MariaDB/mariadb-10.0.15/yum/centos7-amd64/rpms/](https://downloads.mariadb.com/MariaDB/mariadb-10.0.15/yum/centos7-amd64/rpms/)

    ![4%E1%84%8B%E1%85%B5%E1%86%AF%E1%84%8E%E1%85%A1%20-%20%E1%84%86%E1%85%A1%E1%84%85%E1%85%B5%E1%84%8B%E1%85%A1%20DB%20%E1%84%85%E1%85%B5%E1%84%82%E1%85%AE%E1%86%A8%E1%84%89%E1%85%B3%E1%84%85%E1%85%A9%20WAR%20%E1%84%87%E1%85%A2%E1%84%91%E1%85%A9%20CRON%20%E1%84%89%E1%85%A5%E1%84%87%E1%85%A5%E1%84%80%E1%85%A1%E1%86%AB%204cb3334a27164e759fceb4ae833542e2/Untitled.png](4%E1%84%8B%E1%85%B5%E1%86%AF%E1%84%8E%E1%85%A1%20-%20%E1%84%86%E1%85%A1%E1%84%85%E1%85%B5%E1%84%8B%E1%85%A1%20DB%20%E1%84%85%E1%85%B5%E1%84%82%E1%85%AE%E1%86%A8%E1%84%89%E1%85%B3%E1%84%85%E1%85%A9%20WAR%20%E1%84%87%E1%85%A2%E1%84%91%E1%85%A9%20CRON%20%E1%84%89%E1%85%A5%E1%84%87%E1%85%A5%E1%84%80%E1%85%A1%E1%86%AB%204cb3334a27164e759fceb4ae833542e2/Untitled.png)

    - client, common, server

    기존 설치파일이 있을 수 있으니 삭제한다. 그 후 설치한다.

    ```java
    yum -y remove mariadb-libs
    yum -y localinstall Maria*
    ```

    *로컬 인스톨이기 때문에 위치를 꼭 확인한다

- DB 가동 / 상시 가동 옵션 / 리눅스용 유저 등록

    DB를 재시작

    ```jsx
    systemctl restart mysql
    systemctl enable mysql
    systemctl status mysql
    ```

    ```jsx
    [root@localhost 다운로드]# systemctl restart mysql
    [root@localhost 다운로드]# systemctl enable mysql
    mysql.service is not a native service, redirecting to /sbin/chkconfig.
    Executing /sbin/chkconfig mysql on
    [root@localhost 다운로드]# systemctl status mysql
    ● mysql.service - LSB: start and stop MySQL
       Loaded: loaded (/etc/rc.d/init.d/mysql; bad; vendor preset: disabled)
       Active: active (running) since 화 2020-09-15 10:36:50 KST; 21s ago
         Docs: man:systemd-sysv-generator(8)
       CGroup: /system.slice/mysql.service
               ├─4197 /bin/sh /usr/bin/mysqld_safe --datadir=/var/lib/mysql --pid...
               └─4271 /usr/sbin/mysqld --basedir=/usr --datadir=/var/lib/mysql --...

     9월 15 10:36:49 localhost.localdomain systemd[1]: Starting LSB: start and s...
     9월 15 10:36:50 localhost.localdomain mysql[4192]: Starting MySQL. SUCCESS!
     9월 15 10:36:50 localhost.localdomain systemd[1]: Started LSB: start and st...
    Hint: Some lines were ellipsized, use -l to show in full.
    ```

    ```jsx
    [root@localhost ~]# systemctl enable mysql
    mysql.service is not a native service, redirecting to /sbin/chkconfig.
    Executing /sbin/chkconfig mysql on
    [root@localhost ~]# systemctl status mysql
    ● mysql.service - LSB: start and stop MySQL
       Loaded: loaded (/etc/rc.d/init.d/mysql; bad; vendor preset: disabled)
       Active: active (running) since 화 2020-09-15 09:21:52 KST; 1min 30s ago
         Docs: man:systemd-sysv-generator(8)
       CGroup: /system.slice/mysql.service
               ├─4235 /bin/sh /usr/bin/mysqld_safe --datadir=/var/lib/mysql --pid...
               └─4309 /usr/sbin/mysqld --basedir=/usr --datadir=/var/lib/mysql --...

     9월 15 09:21:51 localhost.localdomain systemd[1]: Starting LSB: start and s...
     9월 15 09:21:52 localhost.localdomain mysql[4230]: Starting MySQL. SUCCESS!
     9월 15 09:21:52 localhost.localdomain systemd[1]: Started LSB: start and st...
    Hint: Some lines were ellipsized, use -l to show in full.
    [root@localhost ~]#
    ```

    DB를 상시 가동하기 위한 옵션

    ```jsx
    chkconfig mysql on
    ```

    관리자는 외부에서 접속 못하도록 한게 대부분. 따라서 외부에서 사용할때는 사용자 계정으로만 하도록.

    ex> AWS에 한다면.

    관리자로 들어가기

    관리자 아이디 / 비밀번호 설정

    ```java
    [root@localhost ~]# mysqladmin -u root password '111111' 
    ```

    ```jsx
    [root@localhost ~]# mysql -h localhost -u root -p
    Enter password: 
    Welcome to the MariaDB monitor.  Commands end with ; or \g.
    Your MariaDB connection id is 5
    Server version: 10.0.15-MariaDB MariaDB Server

    Copyright (c) 2000, 2014, Oracle, SkySQL Ab and others.

    Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.
    ```

    어드민 아이디와 비밀번호를 설정 → 로그인

    유저 관리, 마리아DB에선 유저 정보가 하나의 table처럼 관리됨.

    ```jsx
    MariaDB [(none)]> use mysql;
    Reading table information for completion of table and column names
    You can turn off this feature to get a quicker startup with -A

    Database changed
    MariaDB [mysql]>
    ```

    마리아 DB는 대소문자 구분을 한다.

    호스트가 접속 할 수 있는 방법 보여줌

    ```jsx
    MariaDB [mysql]> SELECT user,host FROM user;
    +------+-----------------------+
    | user | host                  |
    +------+-----------------------+
    | root | 127.0.0.1             |
    | root | ::1                   |
    |      | localhost             |
    | root | localhost             |
    |      | localhost.localdomain |
    | root | localhost.localdomain |
    +------+-----------------------+
    6 rows in set (0.00 sec)
    ```

    따라서 다른 URL로는 접근 불가

    ```jsx
    [root@localhost ~]# mysql -h 192.168.111.101 -u root -p
    Enter password: 
    ERROR 1130 (HY000): Host '192.168.111.101' is not allowed to connect to this MariaDB server
    ```

    특정 아이피 어드레스로 들어올 수 있는 유저 생성 + 권한 부여

    ```jsx
    MariaDB [mysql]> GRANT ALL ON *.* TO user1@'192.168.111.%'  IDENTIFIED BY '111111';
    Query OK, 0 rows affected (0.00 sec)
    ```

    로그인

    ```jsx
    [root@localhost ~]# mysql -h 192.168.111.101 -u user1 -p
    ```

    등록된 유저 다시 조회

    ```jsx
    MariaDB [mysql]> SELECT user,host FROM user;
    +-------+-----------------------+
    | user  | host                  |
    +-------+-----------------------+
    | root  | 127.0.0.1             |
    | user1 | 192.168.111.%         |
    | root  | ::1                   |
    |       | localhost             |
    | root  | localhost             |
    |       | localhost.localdomain |
    | root  | localhost.localdomain |
    +-------+-----------------------+
    7 rows in set (0.00 sec)
    ```

    user1 볼 수 있음.

- 윈도우용 유저 등록 / 테이블 생성

    하려는 것.

    윈도우에서 mysql 들어갈 것임. 따라서 윈도우에서 들어올 유저 생성

    ```jsx
    MariaDB [(none)]> use mysql;
    Reading table information for completion of table and column names
    You can turn off this feature to get a quicker startup with -A

    Database changed
    MariaDB [mysql]> GRANT ALL ON *.* TO winuser@'192.168.0.%'  IDENTIFIED BY '111111';
    ```

    윈도우의 ip를 참조하여 ip 타이핑.

    추가한 유저 확인

    ```jsx
    +---------+-----------------------+
    | user    | host                  |
    +---------+-----------------------+
    | root    | 127.0.0.1             |
    | winuser | 192.168.0.%           |
    | user1   | 192.168.111.%         |
    | root    | ::1                   |
    |         | localhost             |
    | root    | localhost             |
    |         | localhost.localdomain |
    | root    | localhost.localdomain |
    +---------+-----------------------+
    ```

    DB생성

    ```jsx
    [root@localhost ~]# mysql -h 127.0.0.1 -u root -p111111
    Welcome to the MariaDB monitor.  Commands end with ; or \g.
    Your MariaDB connection id is 13
    Server version: 10.0.15-MariaDB MariaDB Server

    Copyright (c) 2000, 2014, Oracle, SkySQL Ab and others.

    Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

    MariaDB [(none)]> CREATE DATABASE shopdb CHARACTER SET utf8;
    ```

    utf8로 생성했음.

    winuser의 접속 방법을 추가

    ```jsx
    MariaDB [mysql]> GRANT ALL ON *.* TO winuser@'192.168.111.%'  IDENTIFIED BY '111111';
    Query OK, 0 rows affected (0.00 sec)

    MariaDB [mysql]> SELECT user,host FROM user;
    +---------+-----------------------+
    | user    | host                  |
    +---------+-----------------------+
    | root    | 127.0.0.1             |
    | winuser | 192.168.0.%           |
    | user1   | 192.168.111.%         |
    | winuser | 192.168.111.%         |
    | root    | ::1                   |
    |         | localhost             |
    | root    | localhost             |
    |         | localhost.localdomain |
    | root    | localhost.localdomain |
    +---------+-----------------------+
    9 rows in set (0.00 sec)

    MariaDB [mysql]>
    ```

    GRANT~ 부분을 다시 타이핑 하면 됨.

    로그인하여 db에 접속해본다

    ```jsx
    [root@localhost ~]# mysql -h 192.168.111.101 -u winuser -p111111
    Welcome to the MariaDB monitor.  Commands end with ; or \g.
    Your MariaDB connection id is 15
    Server version: 10.0.15-MariaDB MariaDB Server

    Copyright (c) 2000, 2014, Oracle, SkySQL Ab and others.

    Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

    MariaDB [(none)]> use shopdb;
    Database changed
    ```

    winuser로 테이블을 만든다

    ```sql
    CREATE TABLE items(
    	id VARCHAR(10),
    	name VARCHAR(20),
    	price INT
    );
    INSERT INTO items VALUES('it01','pants1',10000);
    INSERT INTO items VALUES('it02','pants2',20000);
    INSERT INTO items VALUES('it03','pants3',30000);
    SELECT * FROM items;
    ```

### 윈도우에서 리눅스 마리아 DB 내용 가져오기.

- jar 파일 라이브러리 등록 / java파일 설정 및 실행

    다음의 mariadb~.jar 파일을 실행하고자 하는 java 파일의 build path에 external library로 등록한다.

    ![4%E1%84%8B%E1%85%B5%E1%86%AF%E1%84%8E%E1%85%A1%20-%20%E1%84%86%E1%85%A1%E1%84%85%E1%85%B5%E1%84%8B%E1%85%A1%20DB%20%E1%84%85%E1%85%B5%E1%84%82%E1%85%AE%E1%86%A8%E1%84%89%E1%85%B3%E1%84%85%E1%85%A9%20WAR%20%E1%84%87%E1%85%A2%E1%84%91%E1%85%A9%20CRON%20%E1%84%89%E1%85%A5%E1%84%87%E1%85%A5%E1%84%80%E1%85%A1%E1%86%AB%204cb3334a27164e759fceb4ae833542e2/Untitled%201.png](4%E1%84%8B%E1%85%B5%E1%86%AF%E1%84%8E%E1%85%A1%20-%20%E1%84%86%E1%85%A1%E1%84%85%E1%85%B5%E1%84%8B%E1%85%A1%20DB%20%E1%84%85%E1%85%B5%E1%84%82%E1%85%AE%E1%86%A8%E1%84%89%E1%85%B3%E1%84%85%E1%85%A9%20WAR%20%E1%84%87%E1%85%A2%E1%84%91%E1%85%A9%20CRON%20%E1%84%89%E1%85%A5%E1%84%87%E1%85%A5%E1%84%80%E1%85%A1%E1%86%AB%204cb3334a27164e759fceb4ae833542e2/Untitled%201.png)

    이클립스에서 쿼리 해보기

    ```java
    package d01;

    import java.sql.Connection;
    import java.sql.DriverManager;
    import java.sql.PreparedStatement;
    import java.sql.ResultSet;

    public class MariaTest {
    	public static void main(String[] args) throws Exception{
    	String url = "jdbc:mariadb://192.168.111.101:3306/shopdb";
    	String id = "winuser"; //만든 id
    	String password = "111111"; 
    	Class.forName("org.mariadb.jdbc.Driver");
    	Connection con = DriverManager.getConnection(url,id,password);
    	PreparedStatement pstmt = con.prepareStatement("SELECT * FROM items");
    	ResultSet rset = pstmt.executeQuery();
    	while (rset.next()){
    		String did = rset.getString("id");
    		String name = rset.getString("name");
    		int price = rset.getInt("price");
    		System.out.println(did+" "+name+" "+price);
    	}
    	con.close();
    	}
    	
    }
    ```

    오라클 용과 차이나는 부분

    ```java
    mariadb Driver Download - 게시판
    Class.forName("org.mariadb.jdbc.Driver");
    String dbUrl = "jdbc:mariadb://localhost:3306/shopdb";
    string dbUser = "username";
    string dbPasswd = "passwd";
    Connection conn = DriverManager.getConnection(dbUrl, dbUser, dbPasswd);
    ```

    결과값

    ```java
    it01 pants1 10000
    it02 pants2 20000
    it03 pants3 30000
    ```

스프링 등을 이용해서 무언갈 해보는 것도 좋을것이다.

# FTP 설치 및 전송

p.669

### vsftpd설치

vsftpd 설치

```jsx
yum -y install vsftpd
```

19,29,33,35 수정

```jsx
vi /etc/vsftpd/vsftpd.conf
```

```bash
17 #
18 # Uncomment this to enable any form of FTP write command.
19 write_enable=YES
20 #
21 # Default umask for local users is 077. You may wish to change this to 0        22,
22 # if your users expect that (022 is used by most other ftpd's)
---
29 anon_upload_enable=YES
30 #
31 # Uncomment this if you want the anonymous FTP user to be able to create
32 # new directories.
33 anon_mkdir_write_enable=YES
34 #
35 ftpd_banner=Welcome!
36 # Activate directory messages - messages given to remote users when they
```

재시작 및 시작시 실행.

```bash
[root@server2 다운로드]# systemctl restart vsftpd
[root@server2 다운로드]# systemctl enable vsftpd
Created symlink from /etc/systemd/system/multi-user.target.wants/vsftpd.service to /usr/lib/systemd/system/vsftpd.service.
[root@server2 다운로드]#
```

다음위치에 다운로드 등을 할 수 있음. root에 설치되어, 권한을 바꿔주는 과정

```jsx
[root@server2 다운로드]# chown ftp.ftp /var/ftp/pub
[root@server2 다운로드]# ls -l /var/ftp
합계 0
drwxr-xr-x 2 ftp ftp 6  4월  1 13:55 pub
[root@server2 다운로드]# systemctl restart vsftpd
```

```jsx
[root@localhost ~]# vi /etc/vsftpd/vsftpd.conf
[root@localhost ~]# cd /var/ftp
[root@localhost ftp]# ls
pub
[root@localhost ftp]# ls -l pub
합계 0
[root@localhost ftp]# ls -l
합계 0
drwxr-xr-x 2 root root 6  4월  1 13:55 pub
[root@localhost ftp]# chown ftp.ftp /var/ftp/pub
[root@localhost ftp]# ls -l
합계 0
drwxr-xr-x 2 ftp ftp 6  4월  1 13:55 pub
[root@localhost ftp]#
```

파일 확인

```bash
[root@server2 다운로드]# cd /var/ftp/pub
[root@server2 pub]# ls
linux.war
```

### 리눅스를 통해 war 배포하기

[Tomcat에 war파일 배포하는 방법](https://its-easy.tistory.com/4)

만들고 war파일로 저장

전송받은 파일 확인.

```bash
[root@webserver webapps]# cd /var/ftp/pub/
```

war를 복사 /usr/local/apwebaps/

cd /usr/local/apache/webapps

```bash
[root@server2 pub]# cp linux.war /usr/local/apache-tomcat-9.0.37/webapps/
[root@server2 pub]# cp linux.war /usr/local/apache-tomcat-9.0.37/webapps/
[root@server2 pub]# cd /usr/local/apache-tomcat-9.0.37/webapps/
[root@server2 webapps]# ls
ROOT  docs  examples  host-manager  linux  linux.war  manager
[root@server2 webapps]# mv ROOT ROOT_BACK
[root@server2 webapps]# mv linux.war ROOT.war
[root@server2 webapps]# ls
ROOT.war  ROOT_BACK  docs  examples  host-manager  linux  manager
[root@server2 webapps]#
```

![4%E1%84%8B%E1%85%B5%E1%86%AF%E1%84%8E%E1%85%A1%20-%20%E1%84%86%E1%85%A1%E1%84%85%E1%85%B5%E1%84%8B%E1%85%A1%20DB%20%E1%84%85%E1%85%B5%E1%84%82%E1%85%AE%E1%86%A8%E1%84%89%E1%85%B3%E1%84%85%E1%85%A9%20WAR%20%E1%84%87%E1%85%A2%E1%84%91%E1%85%A9%20CRON%20%E1%84%89%E1%85%A5%E1%84%87%E1%85%A5%E1%84%80%E1%85%A1%E1%86%AB%204cb3334a27164e759fceb4ae833542e2/Untitled%202.png](4%E1%84%8B%E1%85%B5%E1%86%AF%E1%84%8E%E1%85%A1%20-%20%E1%84%86%E1%85%A1%E1%84%85%E1%85%B5%E1%84%8B%E1%85%A1%20DB%20%E1%84%85%E1%85%B5%E1%84%82%E1%85%AE%E1%86%A8%E1%84%89%E1%85%B3%E1%84%85%E1%85%A9%20WAR%20%E1%84%87%E1%85%A2%E1%84%91%E1%85%A9%20CRON%20%E1%84%89%E1%85%A5%E1%84%87%E1%85%A5%E1%84%80%E1%85%A1%E1%86%AB%204cb3334a27164e759fceb4ae833542e2/Untitled%202.png)

p.299

# Cron

### 파일 위치 검색

오라클 이름이 붙은 설치 위치

```jsx
[root@localhost webapps]# find / -name "oracle"
```

```jsx
[root@localhost ~]# find ~ -size 0k -exec ls -l {} \;
```

검색값을 {}에 넣고 ls -l이 실행되는 방식

### 실습

/root 에서 *swap 파일을 찾아서 /grabage폴더로 이동 시킨다.

```jsx
[root@localhost Garbage]# find ~ -name "*swap" -exec mv {} /Garbage \;
```

```jsx
[root@localhost Garbage]# locate gzip
[root@localhost Garbage]# whereis gzip
[root@localhost Garbage]# which gzip
```

p.237

at `ctrl +d`

### cron

매일 새벽 5시에 /home dir을 백업해라 home.tar.gz

 매 특정시간에 할 수 있도록 한느 것이 cron

책 반납하지 않음. → 불량으로 변경

주기적으로 시스템 또는 애플리케이션을 동작하여 데이터를 업데이트 한다.

책내용: 매월 15일 새벽 3시 1분에 /home 및 rm gkdnlfmf /backup에 백업

- step1 : crond 서비스 동작 확인

    ```bash
    [root@server2 webapps]# systemctl status crond
    ● crond.service - Command Scheduler
       Loaded: loaded (/usr/lib/systemd/system/crond.service; enabled; vendor preset: enabled)
       Active: active (running) since 화 2020-09-15 16:33:11 KST; 26min ago
     Main PID: 1349 (crond)
        Tasks: 1
       CGroup: /system.slice/crond.service
               └─1349 /usr/sbin/crond -n

     9월 15 16:33:11 server2 systemd[1]: Started Command Scheduler.
     9월 15 16:33:11 server2 crond[1349]: (CRON) INFO (Syslog will be used ins....)
     9월 15 16:33:11 server2 crond[1349]: (CRON) INFO (RANDOM_DELAY will be sc....)
     9월 15 16:33:11 server2 crond[1349]: (CRON) INFO (running with inotify su...t)
    Hint: Some lines were ellipsized, use -l to show in full.
    ```

- step2 : crontab에 실행 일정 추가

    ```bash
    [root@server2 webapps]# gedit /etc/crontab
    SHELL=/bin/bash
    PATH=/sbin:/bin:/usr/sbin:/usr/bin
    MAILTO=root

    # For details see man 4 crontabs

    # Example of job definition:
    # .---------------- minute (0 - 59)
    # |  .------------- hour (0 - 23)
    # |  |  .---------- day of month (1 - 31)
    # |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...
    # |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat
    # |  |  |  |  |
    # *  *  *  *  * user-name  command to be executed
       01 3 15 * * root run-parts /etc/cron.monthly
    ```

- step3: /etc/cron.monthly/ 에 스크립트 파일 저장

[root@localhost ~]# vi /etc/crontab

```jsx
[root@localhost ~]# cd /etc
[root@localhost etc]# ls cron*
cron.deny  crontab

cron.d:
0hourly  raid-check  sysstat

cron.daily:
certwatch  logrotate  man-db.cron  mlocate

cron.hourly:
0anacron

cron.monthly:

cron.weekly:
[root@localhost etc]#
```

매 시간 동작파일만들기

```jsx
[root@localhost cron.hourly]# pwd
/etc/cron.hourly
[root@localhost cron.hourly]# touch backup.sh
[root@localhost cron.hourly]# chmod 744 backup.sh
[root@localhost cron.hourly]# vi backup.sh 
[root@localhost cron.hourly]# backup.sh
```

백업 안의 내용

```jsx
#!/bin/sh

set $(date)
echo $1
echo $2
echo $3
echo $4
~

출력결과
2020.
09.
15.
(화)
```

date를 변수로 선언한 후, 파일이름을 date를 이용해서 만든다. 그리고 백업한다.

```bash
#!/bin/sh

set $(date)
fname="backup-$1$2$3tar.xz"

tar cfJ /backup/$fname /home
~
```

이전 폴더로 이동

```bash
[root@localhost /]# cd -
```

```bash
[root@localhost cron.hourly]# backup.sh
tar: tar (child): Removing leading `/' from member names/backup/backup-2020.09.15.tar.xz: Cannot open
: 그런 파일이나 디렉터리가 없습니다
tar (child): Error is not recoverable: exiting now
[root@localhost cron.hourly]# cd /
[root@localhost /]# mkdir backup
[root@localhost /]# cd -
/etc/cron.hourly
[root@localhost cron.hourly]# backup.sh
tar: Removing leading `/' from member names
[root@localhost cron.hourly]# cd -
/
[root@localhost /]# ls
Garbage  boot   etc      lib    mnt   root  srv  u01    var
backup   cdrom  garbage  lib64  opt   run   sys  usr
bin      dev    home     media  proc  sbin  tmp  utemp
[root@localhost /]# cd backup
[root@localhost backup]# ls
backup-2020.09.15.tar.xz
[root@localhost backup]#
```

crontab을 아래와 같이 수정하고 서비스를 리스타트한다.

```bash
[root@localhost backup]# vi /etc/crontab
[root@localhost backup]# systemctl restart crond
```

```bash
SHELL=/bin/bash
PATH=/sbin:/bin:/usr/sbin:/usr/bin
MAILTO=root

# For details see man 4 crontabs

# Example of job definition:
# .---------------- minute (0 - 59)
# |  .------------- hour (0 - 23)
# |  |  .---------- day of month (1 - 31)
# |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...
# |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat
# |  |  |  |  |
# *  *  *  *  * user-name  command to be executed
  25 * * * * root run-parts /etc/cron.hourly
 
~
```

p.238

### 서버간 통신

Hostname

호스트 네임 변경

```bash
[root@localhost ~]# hostnamectl set-hostname server
```

각 이름을 지어주고, 호스트 파일에 각 내용 추가

```bash
vi /etc/hosts
192.168.111.100 server
192.168.111.101 server1
192.168.111.102 server2
```

게이트웨이(바깥 선이 들어오는) → 라우터

DNS 도메인 네임 서버 (미제놈들이 관리) → [www.naver.com](http://www.naver.com) | 192.168.54.3 → 전세계 로컬 친구들이 다시 미국 서버에서 받아서 저장하고 있음.

본인 / 게이트웨이 / DNS 아이피 세개가 있음.

데이터베이스 서버는 안에만 존재한다.

Public IP

전세계 누구나 올 수 있음. 192.168.34.2 IP를 도메인 이름으로 함. 미국에다가 바로 얘기하면 되지만, cafe24가 대신 해줌.

![4%E1%84%8B%E1%85%B5%E1%86%AF%E1%84%8E%E1%85%A1%20-%20%E1%84%86%E1%85%A1%E1%84%85%E1%85%B5%E1%84%8B%E1%85%A1%20DB%20%E1%84%85%E1%85%B5%E1%84%82%E1%85%AE%E1%86%A8%E1%84%89%E1%85%B3%E1%84%85%E1%85%A9%20WAR%20%E1%84%87%E1%85%A2%E1%84%91%E1%85%A9%20CRON%20%E1%84%89%E1%85%A5%E1%84%87%E1%85%A5%E1%84%80%E1%85%A1%E1%86%AB%204cb3334a27164e759fceb4ae833542e2/Untitled%203.png](4%E1%84%8B%E1%85%B5%E1%86%AF%E1%84%8E%E1%85%A1%20-%20%E1%84%86%E1%85%A1%E1%84%85%E1%85%B5%E1%84%8B%E1%85%A1%20DB%20%E1%84%85%E1%85%B5%E1%84%82%E1%85%AE%E1%86%A8%E1%84%89%E1%85%B3%E1%84%85%E1%85%A9%20WAR%20%E1%84%87%E1%85%A2%E1%84%91%E1%85%A9%20CRON%20%E1%84%89%E1%85%A5%E1%84%87%E1%85%A5%E1%84%80%E1%85%A1%E1%86%AB%204cb3334a27164e759fceb4ae833542e2/Untitled%203.png)

통신 표준 TCP/IP (p.239)

호스트 네임: 그룹 안의 이름

도메인 이름: [www.osh.com](http://www.osh.com)

IP주소 = 네트워크 카드의 주소

0~255로 이루어짐.

공인 아이피 : 외부에서 접근 가능

Private network : 사설 네트워크. 교실내 에서만 가능

넷마스크와 클래스

c클래스:  255.255.255.0으로 한 것. 앞의 3개는 고정. 뒤의 하나는 0~255까지 숫자중에 할당. 253대 까지만 설정 가능

B클래스: 255.255.0.0 → 2^16 

화웨이가 네트워크 점령

네트워크 쪽 진출을 잘 안함 + 교육도 없음.

네트워크 운영관리가 빈틈.

시스템 구성도 - 파악을 잘 해야함.

p.252

```bash
[root@localhost ~]# nslookup www.naver.com
Server:		192.168.111.2
Address:	192.168.111.2#53

Non-authoritative answer:
www.naver.com	canonical name = www.naver.com.nheos.com.
Name:	www.naver.com.nheos.com
Address: 210.89.164.90
Name:	www.naver.com.nheos.com
Address: 210.89.160.88
```

URL을 볼 수 있음.(DNS)

### 파이프, 필터, 리디렉션

나눠보기

```bash
[root@localhost ~]# ls -al /etc | more
```

현재 프로세스를 다 보겠다.(윈도우 작업관리자 비슷)

```bash
ps -ef
```

특정 프로그램 사용여부 확인

```bash
[root@localhost ~]# ps -ef | grep mysql
root       1380      1  0 14:31 ?        00:00:00 /bin/sh /usr/bin/mysqld_safe --datadir=/var/lib/mysql --pid-file=/var/lib/mysql/localhost.localdomain.pid
mysql      1550   1380  0 14:31 ?        00:00:02 /usr/sbin/mysqld --basedir=/usr --datadir=/var/lib/mysql --plugin-dir=/usr/lib64/mysql/plugin --user=mysql --log-error=/var/lib/mysql/localhost.localdomain.err --pid-file=/var/lib/mysql/localhost.localdomain.pid
root       4252   3399  0 15:37 pts/0    00:00:00 grep --color=auto mysql
```

종료시키기(p.254)

```bash
터미널 1
[root@server1 ~]# ps -ef | grep gedit
root       4405   3399  2 15:40 pts/0    00:00:00 gedit
root       4436   4289  0 15:40 pts/1    00:00:00 grep --color=auto gedit
[root@server1 ~]# kill 4405
[root@server1 ~]#

터미널 2
[root@localhost ~]# gedit
종료됨
```

리다이렉트

```bash
[root@localhost ~]# ls -la /etc > list.txt
```

기존 내용에 더하기

```bash
[root@localhost ~]# ls -la /usr/bin >> list.txt
[root@localhost ~]# ls -l list.txt
```

출력값을 더한다.

### 포그라운드 프로세스

콘솔에서 실행되었지만 앞에서 실행되는 것

`ctrl + z` 현재를 멈춤

### 백그라운드 프로세스

뒤에서 도는 것.

강제 종료

kill -9 프로세스번호

실행즉시 백그라운드에서 동작하도록.

```bash
[root@server1 ~]# gedit &
[1] 3385
[root@server1 ~]# ps -ef | grep gedit
root       3385   3294  5 16:12 pts/0    00:00:00 gedit
root       3401   3294  0 16:12 pts/0    00:00:00 grep --color=auto gedit
[root@server1 ~]# kill -9 3385
[1]+  죽었음               gedit
[root@server1 ~]#
```

### 실습 15

무한루프 실행 → 잠시 정지 → 백그라운드 실행 → 현재 실행되는 프로세스 확인 → 1번을 foreground로 바꿈

```bash
[root@server1 ~]# yes>/dev/null
^C
[root@server1 ~]# yes>/dev/null
^Z
[1]+ Stopped yes > /dev/null
[root@server1 ~]# bg
[1]+ yes > /dev/null &
[root@server1 ~]# jobs
[1]+ Running yes > /dev/null &
[root@server1 ~]# fg 1
yes > /dev/null
```

백그라운드에 바로 실행

```bash
[root@server1 ~]# gedit &
[1] 3602
```

불여우, gedit등은 상관없지만 vi를 백그라운드로 실행하면 의미없는 프로세서가 됨.

## 데몬 / 서비스

컴퓨터가 켜지는 순간 동작되는 프로세스들. 

Q. 톰캣도 서비스냐?

A. systemctl로 제어가 되는 친구들

`restart / stop / start / disable / enable`

```bash
systemctl restart network

systemctl restart firewalld

systemctl restart crond

systemctl restart mysql

systemctl restart oracle-xe
```

yum으로 설치한 친구들

Sep 16, 2020 

챕터 6 할것이다. 챕터 5 X window이기

### 마무리

server 2

p238 비타민 퀴즈 4-2

vsftpd 설치 및 실행

tomcat war 전개